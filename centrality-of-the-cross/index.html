<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Centrality of the Cross — Interactive Explorer</title>
  <!-- enable class-based dark mode -->
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-slate-900 text-slate-200 antialiased">
  <!-- ── Header with Tab Menu ─────────────────────────────────────────── -->
  <header class="bg-slate-800 border-b border-slate-700 sticky top-0 z-30">
    <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
      <h1 class="text-2xl font-semibold text-slate-100">Centrality of the Cross</h1>
      <nav class="flex gap-2">
        <button data-section="quotes"
                class="tab-btn px-3 py-1 rounded-md text-sm font-semibold bg-sky-600 text-slate-100">
          Quotes
        </button>
        <button data-section="stats"
                class="tab-btn px-3 py-1 rounded-md text-sm text-slate-300 hover:text-slate-100">
          Reference&nbsp;Stats
        </button>
      </nav>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 py-6 space-y-12">

    <!-- ── Tab 1 — Quotation Explorer ─────────────────────────────────── -->
    <section id="quotes" class="space-y-6">
      <h2 class="text-xl font-semibold text-slate-100">Quotation Explorer</h2>
      <div class="flex gap-4">
        <!-- Pane 1 — Theme Navigator -->
        <aside id="themeFilters"
               class="w-1/5 bg-slate-800 border border-slate-700 p-4 rounded-md max-h-[70vh] overflow-y-auto">
          <h3 class="font-semibold mb-2 text-slate-100">Filter by Theme</h3>
        </aside>

        <!-- Pane 2 — Search + List -->
        <div class="w-1/5 space-y-2">
          <input id="searchInput"
                 type="text"
                 placeholder="Search quotes…"
                 class="w-full px-3 py-2 bg-slate-700 border border-slate-700 rounded-md text-slate-200" />
          <div id="quoteList"
               class="space-y-2 max-h-[65vh] overflow-y-auto snap-y snap-mandatory">
            <!-- quote cards injected here -->
          </div>
        </div>

        <!-- Pane 3 — Quote Detail -->
        <article id="quoteDetail"
                 class="w-2/5 bg-slate-800 border border-slate-700 p-4 rounded-md max-h-[70vh] overflow-y-auto">
          <p class="italic text-slate-400">Select a quote to view its full text.</p>
        </article>

        <!-- Pane 4 — Image -->
        <div class="flex-none w-60 h-[320px] bg-slate-800 border border-slate-700 p-4 rounded-md flex items-center justify-center overflow-hidden">
          <img id="quoteImage"
               src="https://cdn.midjourney.com/da7997ab-ee8f-4d4a-ba71-35d452f6656f/0_1.png"
               alt="Illustration related to the quote"
               class="h-full w-auto object-contain" />
        </div>
      </div>
    </section>

    <!-- ── Tab 2 — Reference Stats ────────────────────────────────────── -->
    <section id="stats" class="space-y-6 hidden">
      <h2 class="text-xl font-semibold text-slate-100">Reference Frequency</h2>
      <p class="text-slate-300">
        The bar chart visualizes how often each publication appears in the quotation set.
      </p>
      <div class="chart-container w-full max-w-3xl mx-auto h-96 bg-slate-800 border border-slate-700 rounded-md p-4">
        <canvas id="refChart"></canvas>
      </div>
    </section>

  </main>

  <!-- ── Scripts ──────────────────────────────────────────────────────── -->
  <script>
    /* ───── Tab Switching ───────────────────────────────────────────── */
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const target = btn.dataset.section;
        // toggle sections
        ['quotes', 'stats'].forEach(id =>
          document.getElementById(id).classList.toggle('hidden', id !== target)
        );
        // toggle active tab styles
        document.querySelectorAll('.tab-btn').forEach(b => {
          if (b.dataset.section === target) {
            b.classList.add('bg-sky-600', 'text-slate-100', 'font-semibold');
            b.classList.remove('text-slate-300');
          } else {
            b.classList.remove('bg-sky-600', 'text-slate-100', 'font-semibold');
            b.classList.add('text-slate-300');
          }
        });
      });
    });

    /* ───── Data ─────────────────────────────────────────────────────── */
    const quotes = [
      { id: 1,  book: "1SM", ref: "1SM p. 372",  title: "Justification by Faith = 3rd Angel’s Message", text: "Several have written to me,…", themes: ["Justification by Faith"] },
      { id: 2,  book: "6BC", ref: "6BC p. 1113", title: "Christ on the Cross is the Gospel", text: "Hanging upon the cross Christ…", themes: ["Centrality of the Cross", "Transforming Power of Love"] },
      { id: 3,  book: "6T",  ref: "6T p. 67",  title: "Christ Crucified—Talk It, Pray It, Sing It", text: "Christ gave Himself to a…", themes: ["Transforming Power of Love"] },
      { id: 4,  book: "6BC", ref: "6BC p. 1113", title: "Cross the Center of Attraction", text: "The cross of Calvary challenges,…", themes: ["Centrality of the Cross"] },
      { id: 5,  book: "1SM", ref: "1SM p. 384", title: "John’s Love Propitiation", text: "Let us repeat and make…", themes: ["Transforming Power of Love"] },
      { id: 6,  book: "AA",  ref: "AA p. 209",  title: "One Look at the Cross Transforms", text: "If those who today are…", themes: ["Transforming Power of Love"] },
      { id: 7,  book: "GW",  ref: "GW pp. 157-158", title: "Theory of Truth and Redeeming Love", text: "There are those who listen…", themes: ["Transforming Power of Love"] },
      { id: 8,  book: "GW",  ref: "GW pp. 156-157", title: "Adventists Foremost in Uplifting Christ", text: "Of all professing Christians, Seventh…", themes: ["Educational Foundation"] },
      { id: 9,  book: "GW",  ref: "GW p. 315", title: "Cross: Foundation of Every Discourse", text: "The sacrifice of Christ as…", themes: ["Centrality of the Cross"] },
      { id: 10, book: "EV",  ref: "EV p. 190", title: "Mystery of the Cross Explained", text: "The mystery of the cross…", themes: ["Final Vindication"] },
      { id: 11, book: "Ed",  ref: "Ed p. 30", title: "Education and Redemption United", text: "In the highest sense the…", themes: ["Educational Foundation"] },
      { id: 12, book: "CT",  ref: "CT pp. 23-24", title: "Cross: Teach Every Student", text: "The cross of Christ—teach it…", themes: ["Educational Foundation"] },
      { id: 13, book: "CT",  ref: "CT p. 338", title: "Enthusiasm for the Cross", text: "If there is anything in…", themes: ["Transforming Power of Love"] },
      { id: 14, book: "DA",  ref: "DA p. 493", title: "Pardoning Love of Christ", text: "Nothing reaches so fully down…", themes: ["Transforming Power of Love"] },
      { id: 15, book: "DA",  ref: "DA p. 480", title: "Love Softens and Subdues", text: "It is not the fear…", themes: ["Transforming Power of Love"] },
      { id: 16, book: "AA",  ref: "AA pp. 245-246", title: "Christ’s Love Compels", text: "Christ's love compels us, because…", themes: ["Transforming Power of Love"] },
      { id: 17, book: "DA",  ref: "DA p. 660", title: "Keep the Love of Jesus Fresh", text: "The love of Jesus, with…", themes: ["Transforming Power of Love"] },
      { id: 18, book: "DA",  ref: "DA p. 661", title: "Beholding Christ Crucified Elevates", text: "He who beholds the Saviour's…", themes: ["Transforming Power of Love"] },
      { id: 19, book: "TM",  ref: "TM p. 378", title: "Love Restores and Strengthens the Soul", text: "The love of God is…", themes: ["Transforming Power of Love"] },
      { id: 20, book: "DA",  ref: "DA p. 22", title: "Only by Love is Love Awakened", text: "That the world might be…", themes: ["Transforming Power of Love"] },
      { id: 21, book: "MB",  ref: "MB pp. 76-77", title: "Transforming Power of God’s Love", text: "With untold love our God…", themes: ["Transforming Power of Love"] },
      { id: 22, book: "1SM", ref: "1SM p. 312", title: "Correct View of God’s Love", text: "As soon as we have…", themes: ["Transforming Power of Love"] },
      { id: 23, book: "1SM", ref: "1SM p. 359", title: "Present Message of Holiness", text: "The present message—justification by faith—is…", themes: ["Justification by Faith"] },
      { id: 24, book: "TM",  ref: "TM p. 456", title: "Justification Lays Human Glory in the Dust", text: "What is justification by faith?…", themes: ["Justification by Faith"] },
      { id: 25, book: "DA",  ref: "DA p. 661", title: "Praise in Hearts and Lips", text: "Praise to God and the…", themes: ["Transforming Power of Love"] },
      { id: 26, book: "ST",  ref: "ST Dec 30, 1889", title: "Faith Strengthened by Contemplation", text: "If men would contemplate the…", themes: ["Justification by Faith"] },
      { id: 27, book: "AA",  ref: "AA p. 209-210", title: "Union with the Father Through the Cross", text: "Without the cross, man could…", themes: ["Centrality of the Cross"] },
      { id: 28, book: "MB",  ref: "MB p. 29", title: "Presenting Christ’s Love", text: "When one presents the love…", themes: ["Transforming Power of Love"] },
      { id: 29, book: "MB",  ref: "MB p. 115", title: "Knowing and Believing God’s Love", text: "The one thing essential for…", themes: ["Transforming Power of Love"] },
      { id: 30, book: "MB",  ref: "MB pp. 384-385", title: "Satan’s Determination", text: "Satan is determined that men…", themes: ["Final Vindication"] },
      { id: 31, book: "1SM", ref: "1SM p. 363a", title: "Beginning of the Loud Cry", text: "The time of test is…", themes: ["Final Vindication"] },
      { id: 32, book: "MB",  ref: "MB p. 44", title: "Cross as Center of Influence", text: "The cross of Calvary is…", themes: ["Centrality of the Cross"] },
      { id: 33, book: "ST",  ref: "ST p. 202", title: "Clear Steady View Counters Worldliness", text: "A clear, steady view of…", themes: ["Centrality of the Cross"] },
      { id: 34, book: "MB",  ref: "MB pp. 128-129a", title: "No Criticism in the Cross’s Shadow", text: "He who looks often upon…", themes: ["Transforming Power of Love"] },
      { id: 35, book: "MB",  ref: "MB pp. 128-129b", title: "Sacrificial Humility and Brotherly Love", text: "Not until you feel that…", themes: ["Transforming Power of Love"] },
      { id: 36, book: "GW",  ref: "GW pp. 51-55; 8T pp. 331-332", title: "Meditation Leads to Transformation", text: "The knowledge of God that…", themes: ["Transforming Power of Love"] },
      { id: 37, book: "1SM", ref: "1SM p. 385", title: "Pledge and Unity of the Cross", text: "Look at the cross of…", themes: ["Centrality of the Cross"] },
      { id: 38, book: "1SM", ref: "1 SM p. 93", title: "No Time for Controversy", text: "There is no time to…", themes: ["Centrality of the Cross"] },
      { id: 39, book: "6T",  ref: "6T pp. 235-236", title: "Demonstrating Influence of the Cross", text: "Our work in all its…", themes: ["Centrality of the Cross"] },
      { id: 40, book: "Eph.",ref: "Eph. 3:16-21, NIV", title: "Paul’s Prayer for Spiritual Strength", text: "I pray that out of…", themes: ["Transforming Power of Love"] },
      { id: 41, book: "AA",  ref: "AA p. 210", title: "Infinite Love Revealed through the Cross", text: "Through the cross we learn…", themes: ["Transforming Power of Love"] },
      { id: 42, book: "DA",  ref: "DA p. 660", title: "Daily Sustenance through Calvary", text: "To the death of Christ…", themes: ["Transforming Power of Love"] },
      { id: 43, book: "1SM", ref: "1SM p. 343", title: "High Priest Advocate", text: "Christ as high priest within…", themes: ["Centrality of the Cross"] },
      { id: 44, book: "1SM", ref: "1SM p. 363b", title: "Righteousness for Time of Trouble", text: "If you would stand through…", themes: ["Justification by Faith"] },
      { id: 45, book: "DA",  ref: "DA p. 660", title: "Necessity of Christ’s Death", text: "Nothing less than the death…", themes: ["Centrality of the Cross"] },
      { id: 46, book: "DA",  ref: "DA p. 58", title: "Judgement and Vindication of the Cross", text: "In the day of final…", themes: ["Final Vindication"] },
      { id: 47, book: "TM",  ref: "TM p. 433", title: "Song of Moses and the Lamb", text: "There is a day just…", themes: ["Final Vindication"] },
      { id: 48, book: "GC",  ref: "GC pp. 651-652", title: "Science and Song of Christ Crucified", text: "The cross of Christ will…", themes: ["Final Vindication"] }
    ];

    const themeDescriptions = [
      "Justification by Faith",
      "Centrality of the Cross",
      "Transforming Power of Love",
      "Educational Foundation",
      "Final Vindication"
    ];

    /* ───── Theme Filters ────────────────────────────────────────────── */
    function buildThemeFilters() {
      const container = document.getElementById('themeFilters');
      const allBtn = document.createElement('button');
      allBtn.textContent = 'All Themes';
      allBtn.className = 'block w-full text-left mb-1 py-1 text-slate-200';
      allBtn.addEventListener('click', () => {
        selectedTheme = null;
        highlightActiveTheme();
        renderQuoteCards(searchInput.value);
      });
      container.appendChild(allBtn);

      themeDescriptions.forEach(name => {
        const btn = document.createElement('button');
        const count = quotes.filter(q => q.themes?.includes(name)).length;
        btn.textContent = `${name} (${count})`;
        btn.className = 'block w-full text-left mb-1 py-1 text-slate-200';
        btn.dataset.theme = name;
        btn.addEventListener('click', () => {
          selectedTheme = name;
          highlightActiveTheme();
          renderQuoteCards(searchInput.value);
        });
        container.appendChild(btn);
      });
    }

    function highlightActiveTheme() {
      document.querySelectorAll('#themeFilters button').forEach(btn => {
        const isAll = btn.textContent.startsWith('All Themes');
        if ((isAll && !selectedTheme) || btn.dataset.theme === selectedTheme) {
          btn.classList.add('font-bold', 'bg-sky-600');
        } else {
          btn.classList.remove('font-bold', 'bg-sky-600');
        }
      });
    }

    /* ───── Quote Cards ──────────────────────────────────────────────── */
    const searchInput = document.getElementById('searchInput');
    let selectedTheme = null;

    function renderQuoteCards(filterText = '') {
      const listEl = document.getElementById('quoteList');
      listEl.innerHTML = '';
      quotes
        .filter(q => {
          const txt = filterText.toLowerCase();
          const inText = q.title.toLowerCase().includes(txt) || q.text.toLowerCase().includes(txt);
          const inTheme = !selectedTheme || q.themes?.includes(selectedTheme);
          return inText && inTheme;
        })
        .forEach(q => {
          const card = document.createElement('div');
          card.className = "p-3 bg-slate-800 border border-slate-700 rounded-md cursor-pointer hover:bg-slate-700 snap-start";
          card.dataset.id = q.id;
          card.innerHTML = `
            <p class="font-semibold text-slate-100">${q.title}</p>
            <p class="text-xs text-slate-400">${q.ref}</p>
          `;
          listEl.appendChild(card);
        });
    }

    /* ───── Quote Detail & Image ─────────────────────────────────────── */
    document.getElementById('quoteList').addEventListener('click', e => {
      const id = e.target.closest('[data-id]')?.dataset.id;
      if (!id) return;
      const q = quotes.find(x => x.id == id);
      document.getElementById('quoteDetail').innerHTML = `
        <h3 class="text-lg font-semibold mb-2 text-slate-100">${q.title}</h3>
        <p class="mb-4 whitespace-pre-line text-slate-200">${q.text}</p>
        <p class="text-sm text-slate-400">Reference: ${q.ref}</p>
      `;
      document.getElementById('quoteImage').src = q.imageUrl || document.getElementById('quoteImage').src;
    });
    searchInput.addEventListener('input', e => renderQuoteCards(e.target.value));

    /* ───── Reference Chart ─────────────────────────────────────────── */
    function buildChart() {
      const ctx = document.getElementById('refChart').getContext('2d');
      const counts = {};
      quotes.forEach(q => counts[q.book] = (counts[q.book] || 0) + 1);
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: Object.keys(counts),
          datasets: [{ label: 'Count', data: Object.values(counts), borderWidth: 1 }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: { y: { beginAtZero: true, ticks: { precision: 0 } } },
          plugins: { legend: { display: false } }
        }
      });
    }

    /* ───── Initialize ──────────────────────────────────────────────── */
    buildThemeFilters();
    highlightActiveTheme();
    renderQuoteCards();
    buildChart();
  </script>
</body>
</html>
